"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9029],{2844:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"documentation/ssl","title":"SSL","description":"As part of the connection options, you can specify the ssl object property or a string containing the SSL profile content (deprecated).","source":"@site/docs/documentation/ssl.mdx","sourceDirName":"documentation","slug":"/documentation/ssl","permalink":"/node-mysql2/docs/documentation/ssl","draft":false,"unlisted":false,"editUrl":"https://github.com/sidorares/node-mysql2/tree/master/website/docs/documentation/ssl.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Promise Wrappers","permalink":"/node-mysql2/docs/documentation/promise-wrapper"},"next":{"title":"Using MySQL2 with TypeScript","permalink":"/node-mysql2/docs/documentation/typescript-examples"}}');var o=s(4848),r=s(8453);const i={},a="SSL",c={},l=[{value:"SSL Options",id:"ssl-options",level:2},{value:"SSL Certificate Bundle",id:"ssl-certificate-bundle",level:2},{value:"SSL Profile (deprecated)",id:"ssl-profile-deprecated",level:2},{value:"Ignoring Unauthorized SSL Errors",id:"ignoring-unauthorized-ssl-errors",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"ssl",children:"SSL"})}),"\n",(0,o.jsxs)(n.p,{children:["As part of the connection options, you can specify the ",(0,o.jsx)(n.code,{children:"ssl"})," object property or a string containing the SSL profile content (",(0,o.jsx)(n.strong,{children:"deprecated"}),")."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"ssl?: string | SslOptions;\n"})}),"\n",(0,o.jsxs)(n.p,{children:["See full list of ",(0,o.jsx)(n.a,{href:"https://github.com/sidorares/node-mysql2/blob/master/typings/mysql/lib/Connection.d.ts#L24-L80",children:"SslOptions"}),", which are in the same format as ",(0,o.jsx)(n.a,{href:"https://nodejs.org/api/tls.html#tls_tls_createsecurecontext_options",children:"tls.createSecureContext"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"ssl-options",children:"SSL Options"}),"\n",(0,o.jsx)(n.p,{children:"To enable SSL without manually providing certificates and assuming they are already trusted by the host machine, you can specify an empty object, for example:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"const connection = await mysql.createConnection({\n  host: 'localhost',\n  ssl: {},\n});\n"})}),"\n",(0,o.jsx)(n.p,{children:"You can also specify custom certificate(s) as an individual string or array of strings. Please note the arguments expect a string of the certificate, not a file name to the certificate:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import fs from 'node:fs';\n\nconst connection = await mysql.createConnection({\n  host: 'localhost',\n  ssl: {\n    ca: fs.readFileSync(__dirname + '/mysql-ca.crt'),\n  },\n});\n"})}),"\n",(0,o.jsxs)(n.p,{children:["When a certificate is read from an environment variable, it's recommended to replace escaped ",(0,o.jsx)(n.code,{children:"\\n"})," characters with proper new line characters, for example:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"const connection = await mysql.createConnection({\n  host: 'localhost',\n  ssl: {\n    ca: process.env.DB_SSL_CA?.replace(/\\\\n/gm, '\\n'),\n  },\n});\n"})}),"\n",(0,o.jsx)(n.h2,{id:"ssl-certificate-bundle",children:"SSL Certificate Bundle"}),"\n",(0,o.jsx)(n.p,{children:"Alternatively, you can use a bundle with CA certificates. For example for Amazon RDS you could use:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import awsCaBundle from 'aws-ssl-profiles';\n\nconst connection = await mysql.createConnection({\n  host: 'db.id.ap-southeast-2.rds.amazonaws.com',\n  ssl: awsCaBundle,\n});\n"})}),"\n",(0,o.jsxs)(n.p,{children:["For detailed instructions, please follow ",(0,o.jsx)(n.a,{href:"https://github.com/mysqljs/aws-ssl-profiles",children:"aws-ssl-profiles"})," documentation."]}),"\n",(0,o.jsx)(n.h2,{id:"ssl-profile-deprecated",children:"SSL Profile (deprecated)"}),"\n",(0,o.jsxs)(n.p,{children:["There is also a ",(0,o.jsx)(n.strong,{children:"deprecated option"})," allowing to specify a string containing name of SSL profile:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"const connection = await mysql.createConnection({\n  host: 'localhost',\n  ssl: 'Amazon RDS',\n});\n"})}),"\n",(0,o.jsx)(n.p,{children:"Following profiles are included in the package:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Amazon RDS"})," - in this case ",(0,o.jsx)(n.a,{href:"https://s3.amazonaws.com/rds-downloads/mysql-ssl-ca-cert.pem",children:"https://s3.amazonaws.com/rds-downloads/mysql-ssl-ca-cert.pem"})," CA cert is used"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"ignoring-unauthorized-ssl-errors",children:"Ignoring Unauthorized SSL Errors"}),"\n",(0,o.jsxs)(n.p,{children:["You can also connect to a MySQL server without providing an appropriate CA to trust. ",(0,o.jsx)(n.strong,{children:"This is highly discouraged"})," as being insecure."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"const connection = await mysql.createConnection({\n  host: 'localhost',\n  ssl: {\n    // Beware, set `rejectUnauthorized` as `false` is strongly discouraged for security reasons:\n    rejectUnauthorized: false,\n  },\n});\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>a});var t=s(6540);const o={},r=t.createContext(o);function i(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);