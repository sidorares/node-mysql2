"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3269],{1470:(e,n,s)=>{s.d(n,{A:()=>C});var o=s(6540),a=s(4164),r=s(7559),t=s(3104),l=s(6347),i=s(205),c=s(7485),d=s(1682),u=s(679);function m(e){return o.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,o.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:n,children:s}=e;return(0,o.useMemo)(()=>{const e=n??function(e){return m(e).map(({props:{value:e,label:n,attributes:s,default:o}})=>({value:e,label:n,attributes:s,default:o}))}(s);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,s])}function h({value:e,tabValues:n}){return n.some(n=>n.value===e)}function x({queryString:e=!1,groupId:n}){const s=(0,l.W6)(),a=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(a),(0,o.useCallback)(e=>{if(!a)return;const n=new URLSearchParams(s.location.search);n.set(a,e),s.replace({...s.location,search:n.toString()})},[a,s])]}function j(e){const{defaultValue:n,queryString:s=!1,groupId:a}=e,r=p(e),[t,l]=(0,o.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const s=n.find(e=>e.default)??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:r})),[c,d]=x({queryString:s,groupId:a}),[m,j]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[s,a]=(0,u.Dv)(n);return[s,(0,o.useCallback)(e=>{n&&a.set(e)},[n,a])]}({groupId:a}),f=(()=>{const e=c??m;return h({value:e,tabValues:r})?e:null})();(0,i.A)(()=>{f&&l(f)},[f]);return{selectedValue:t,selectValue:(0,o.useCallback)(e=>{if(!h({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),j(e)},[d,j,r]),tabValues:r}}var f=s(2303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=s(4848);function v({className:e,block:n,selectedValue:s,selectValue:o,tabValues:r}){const l=[],{blockElementScrollPositionUntilNextRender:i}=(0,t.a_)(),c=e=>{const n=e.currentTarget,a=l.indexOf(n),t=r[a].value;t!==s&&(i(n),o(t))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const s=l.indexOf(e.currentTarget)+1;n=l[s]??l[0];break}case"ArrowLeft":{const s=l.indexOf(e.currentTarget)-1;n=l[s]??l[l.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},e),children:r.map(({value:e,label:n,attributes:o})=>(0,b.jsx)("li",{role:"tab",tabIndex:s===e?0:-1,"aria-selected":s===e,ref:e=>{l.push(e)},onKeyDown:d,onClick:c,...o,className:(0,a.A)("tabs__item",g.tabItem,o?.className,{"tabs__item--active":s===e}),children:n??e},e))})}function y({lazy:e,children:n,selectedValue:s}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find(e=>e.props.value===s);return e?(0,o.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:r.map((e,n)=>(0,o.cloneElement)(e,{key:n,hidden:e.props.value!==s}))})}function q(e){const n=j(e);return(0,b.jsxs)("div",{className:(0,a.A)(r.G.tabs.container,"tabs-container",g.tabList),children:[(0,b.jsx)(v,{...n,...e}),(0,b.jsx)(y,{...n,...e})]})}function C(e){const n=(0,f.A)();return(0,b.jsx)(q,{...e,children:m(e.children)},String(n))}},1747:(e,n,s)=>{s.d(n,{s:()=>r});var o=s(5260),a=s(4848);const r=({title:e})=>(0,a.jsx)(o.A,{children:(0,a.jsx)("title",{children:e})})},5023:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>u,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>o,toc:()=>m});const o=JSON.parse('{"id":"index","title":"Guia R\xe1pido","description":"Cliente MySQL para Node.js com foco em performance","source":"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/index.mdx","sourceDirName":".","slug":"/","permalink":"/node-mysql2/pt-BR/docs/","draft":false,"unlisted":false,"editUrl":"https://github.com/sidorares/node-mysql2/tree/master/website/docs/index.mdx","tags":[],"version":"current","frontMatter":{"slug":"/","position":1,"title":"Guia R\xe1pido","description":"Cliente MySQL para Node.js com foco em performance"},"sidebar":"docs","next":{"title":"Hist\xf3ria e Porque o MySQL2","permalink":"/node-mysql2/pt-BR/docs/history-and-why-mysq2"}}');var a=s(4848),r=s(8453),t=s(1470),l=s(9365),i=s(1747);const c={slug:"/",position:1,title:"Guia R\xe1pido",description:"Cliente MySQL para Node.js com foco em performance"},d="MySQL2",u={},m=[{value:"Instala\xe7\xe3o",id:"instala\xe7\xe3o",level:2},{value:"Primeira Consulta (<em>Query</em>)",id:"primeira-consulta-query",level:3},{value:"Usando Instru\xe7\xf5es Preparadas (<em>Prepared Statements</em>)",id:"usando-instru\xe7\xf5es-preparadas-prepared-statements",level:3},{value:"Usando Conjunto de Conex\xf5es (<em>pools</em>)",id:"using-connection-pools",level:3},{value:"Usando o <em>Promise Wrapper</em>",id:"usando-o-promise-wrapper",level:3},{value:"Resultados em <em>Array</em>",id:"resultados-em-array",level:3},{value:"Connection Level",id:"connection-level",level:4},{value:"Query Level",id:"query-level",level:4}];function p(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.s,{title:"MySQL2 | Guia R\xe1pido"}),"\n",(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"mysql2",children:"MySQL2"})}),"\n","\n",(0,a.jsxs)(n.p,{children:["Cliente MySQL para Node.js com foco em performance. Suporta instru\xe7\xf5es preparadas (",(0,a.jsx)(n.em,{children:"prepared statements"}),"), Codifica\xe7\xf5es ",(0,a.jsx)(n.em,{children:"non-utf8"}),", protocolo de log bin\xe1rio (",(0,a.jsx)(n.em,{children:"binary log protocol"}),"), compress\xe3o, SSL e muito mais."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"https://npmjs.org/package/mysql2",children:(0,a.jsx)(n.img,{src:"https://img.shields.io/npm/v/mysql2.svg",alt:"NPM Version"})}),"\n",(0,a.jsx)(n.a,{href:"https://npmjs.org/package/mysql2",children:(0,a.jsx)(n.img,{src:"https://img.shields.io/npm/dm/mysql2.svg",alt:"NPM Downloads"})}),"\n",(0,a.jsx)(n.a,{href:"https://nodejs.org/download/",children:(0,a.jsx)(n.img,{src:"https://img.shields.io/node/v/mysql2.svg",alt:"Node.js Version"})}),"\n",(0,a.jsx)(n.a,{href:"https://github.com/sidorares/node-mysql2/actions/workflows/ci-coverage.yml?query=branch%3Amaster",children:(0,a.jsx)(n.img,{src:"https://img.shields.io/github/actions/workflow/status/sidorares/node-mysql2/ci-coverage.yml?event=push&style=flat&label=CI&branch=master",alt:"GitHub Workflow Status (with event)"})}),"\n",(0,a.jsx)(n.a,{href:"https://app.codecov.io/github/sidorares/node-mysql2",children:(0,a.jsx)(n.img,{src:"https://img.shields.io/codecov/c/github/sidorares/node-mysql2",alt:"Codecov"})}),"\n",(0,a.jsx)(n.a,{href:"https://github.com/sidorares/node-mysql2/blob/master/License",children:(0,a.jsx)(n.img,{src:"https://img.shields.io/npm/l/mysql2.svg?maxAge=2592000",alt:"License"})})]}),"\n",(0,a.jsx)(n.h2,{id:"instala\xe7\xe3o",children:"Instala\xe7\xe3o"}),"\n",(0,a.jsx)(n.p,{children:"O MySQL2 n\xe3o tem restri\xe7\xf5es nativas e pode ser instalado no Linux, Mac OS ou Windows sem qualquer problema."}),"\n",(0,a.jsxs)(t.A,{children:[(0,a.jsx)(l.A,{value:"JavaScript",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm install --save mysql2\n"})})}),(0,a.jsxs)(l.A,{value:"TypeScript",children:[(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm install --save mysql2\nnpm install --save-dev @types/node\n"})}),(0,a.jsxs)(n.p,{children:["Para documenta\xe7\xe3o e exemplos usando TypeScript, veja ",(0,a.jsx)(n.a,{href:"/docs/documentation/typescript-examples",children:"aqui"}),"."]})]})]}),"\n",(0,a.jsx)("hr",{}),"\n",(0,a.jsxs)(n.h3,{id:"primeira-consulta-query",children:["Primeira Consulta (",(0,a.jsx)(n.em,{children:"Query"}),")"]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["Para explorar mais exemplos de consulta (queries), visite a se\xe7\xe3o de exemplos ",(0,a.jsx)(n.a,{href:"/docs/examples/queries/simple-queries",children:(0,a.jsx)(n.strong,{children:"Consultas Simples"})})," e ",(0,a.jsx)(n.a,{href:"/docs/examples/queries/prepared-statements",children:(0,a.jsxs)(n.strong,{children:["Instru\xe7\xf5es Preparadas (",(0,a.jsx)(n.em,{children:"Prepared Statements"}),")"]})}),"."]}),"\n"]}),"\n",(0,a.jsxs)(t.A,{children:[(0,a.jsx)(l.A,{value:"Promise",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"// Obt\xe9m o cliente\nimport mysql from 'mysql2/promise';\n\n// Cria a conex\xe3o com o Banco de Dados\nconst connection = await mysql.createConnection({\n  host: 'localhost',\n  user: 'root',\n  database: 'test',\n});\n\n// Consulta simples\ntry {\n  const [results, fields] = await connection.query(\n    'SELECT * FROM `table` WHERE `name` = \"Page\" AND `age` > 45'\n  );\n\n  console.log(results); // \"results\" cont\xeam as linhas retornadas pelo servidor\n  console.log(fields); // \"fields\" cont\xeam metadados adicionais sobre os resultados, quando dispon\xedveis\n} catch (err) {\n  console.log(err);\n}\n\n// Utilizando espa\xe7os reservados (placeholders)\ntry {\n  const [results] = await connection.query(\n    'SELECT * FROM `table` WHERE `name` = ? AND `age` > ?',\n    ['Page', 45]\n  );\n\n  console.log(results);\n} catch (err) {\n  console.log(err);\n}\n"})})}),(0,a.jsx)(l.A,{value:"Callback",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"// Obt\xe9m o cliente\nconst mysql = require('mysql2');\n\n// Cria a conex\xe3o com o Banco de Dados\nconst connection = mysql.createConnection({\n  host: 'localhost',\n  user: 'root',\n  database: 'test',\n});\n\n// Consulta simples\nconnection.query(\n  'SELECT * FROM `table` WHERE `name` = \"Page\" AND `age` > 45',\n  function (err, results, fields) {\n    console.log(results); // \"results\" cont\xeam as linhas retornadas pelo servidor\n    console.log(fields); // \"fields\" cont\xeam metadados adicionais sobre os resultados, quando dispon\xedveis\n  }\n);\n\n// Utilizando espa\xe7os reservados (placeholders)\nconnection.query(\n  'SELECT * FROM `table` WHERE `name` = ? AND `age` > ?',\n  ['Page', 45],\n  function (err, results) {\n    console.log(results);\n  }\n);\n"})})})]}),"\n",(0,a.jsx)("hr",{}),"\n",(0,a.jsxs)(n.h3,{id:"usando-instru\xe7\xf5es-preparadas-prepared-statements",children:["Usando Instru\xe7\xf5es Preparadas (",(0,a.jsx)(n.em,{children:"Prepared Statements"}),")"]}),"\n",(0,a.jsx)(n.p,{children:"Com o MySQL2 voc\xea tamb\xe9m pode obter Instru\xe7\xf5es Preparadas (Prepared Statements). Dessa forma o MySQL n\xe3o precisa preparar um plano para a mesma consulta todas as vezes, resultando em um melhor desempenho. Se voc\xea n\xe3o sabe por que isso \xe9 importante, veja essa discuss\xe3o:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsxs)(n.a,{href:"https://stackoverflow.com/questions/8263371/how-can-prepared-statements-protect-from-sql-injection-attacks",children:["Como as instru\xe7\xf5es preparadas (",(0,a.jsx)(n.em,{children:"prepared statements"}),") podem proteger contra ataques de inje\xe7\xe3o SQL"]})}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["O MySQL2 fornece o m\xe9todo auxiliar ",(0,a.jsx)(n.code,{children:"execute"})," que ir\xe1 preparar e consultar as declara\xe7\xf5es (",(0,a.jsx)(n.em,{children:"statements"}),") SQL. Al\xe9m disso, voc\xea tamb\xe9m pode usar os m\xe9todos ",(0,a.jsx)(n.code,{children:"prepare"})," e ",(0,a.jsx)(n.code,{children:"unprepare"})," para preparar ou desfazer a prepara\xe7\xe3o de declara\xe7\xf5es (",(0,a.jsx)(n.em,{children:"statements"}),") manualmente, se necess\xe1rio."]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["Para explorar mais exemplos de Instru\xe7\xf5es Preparadas (",(0,a.jsx)(n.em,{children:"Prepared Statements"}),"), visite a se\xe7\xe3o de exemplos ",(0,a.jsx)(n.a,{href:"/docs/examples/queries/prepared-statements",children:(0,a.jsxs)(n.strong,{children:["Instru\xe7\xf5es Preparadas (",(0,a.jsx)(n.em,{children:"Prepared Statements"}),")"]})}),"."]}),"\n"]}),"\n",(0,a.jsxs)(t.A,{children:[(0,a.jsx)(l.A,{value:"Promise",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"import mysql from 'mysql2/promise';\n\ntry {\n  // Cria a conex\xe3o com o Banco de Dados\n  const connection = await mysql.createConnection({\n    host: 'localhost',\n    user: 'root',\n    database: 'test',\n  });\n\n  // \"execute\" ir\xe1 chamar internamente a prepara\xe7\xe3o e a consulta (query)\n  const [results, fields] = await connection.execute(\n    'SELECT * FROM `table` WHERE `name` = ? AND `age` > ?',\n    ['Rick C-137', 53]\n  );\n\n  console.log(results); // \"results\" cont\xeam as linhas retornadas pelo servidor\n  console.log(fields); // \"fields\" cont\xeam metadados adicionais sobre os resultados, quando dispon\xedveis\n} catch (err) {\n  console.log(err);\n}\n"})})}),(0,a.jsx)(l.A,{value:"Callback",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"const mysql = require('mysql2');\n\n// Cria a conex\xe3o com o Banco de Dados\nconst connection = mysql.createConnection({\n  host: 'localhost',\n  user: 'root',\n  database: 'test',\n});\n\n// \"execute\" ir\xe1 chamar internamente a prepara\xe7\xe3o e a consulta (query)\nconnection.execute(\n  'SELECT * FROM `table` WHERE `name` = ? AND `age` > ?',\n  ['Rick C-137', 53],\n  function (err, results, fields) {\n    console.log(results); // \"results\" cont\xeam as linhas retornadas pelo servidor\n    console.log(fields); // \"fields\" cont\xeam metadados adicionais sobre os resultados, quando dispon\xedveis\n  }\n);\n"})})})]}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsx)(n.p,{children:"Se voc\xea executar a mesma declara\xe7\xe3o novamente, ela ser\xe1 selecionada a partir do LRU Cache, o que economizar\xe1 tempo de prepara\xe7\xe3o da consulta e proporcionar\xe1 melhor desempenho."})}),"\n",(0,a.jsx)("hr",{}),"\n",(0,a.jsxs)(n.h3,{id:"using-connection-pools",children:["Usando Conjunto de Conex\xf5es (",(0,a.jsx)(n.em,{children:"pools"}),")"]}),"\n",(0,a.jsxs)(n.p,{children:["O conjunto de conex\xf5es (",(0,a.jsx)(n.em,{children:"pools"}),") ajuda a reduzir o tempo gasto na conex\xe3o com o servidor MySQL, reutilizando uma conex\xe3o anterior e deixando-as abertas ao inv\xe9s de fech\xe1-las quando voc\xea termina de us\xe1-las."]}),"\n",(0,a.jsxs)(n.p,{children:["Isto melhora a lat\xeancia das consultas (",(0,a.jsx)(n.em,{children:"queries"}),"), pois evita toda a sobrecarga associada \xe0 cria\xe7\xe3o de uma nova conex\xe3o."]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["Para explorar mais exemplos de Conjunto de Conex\xf5es (",(0,a.jsx)(n.em,{children:"pools"}),"), visite a se\xe7\xe3o de exemplos ",(0,a.jsx)(n.a,{href:"/docs/examples/connections/create-pool",children:(0,a.jsx)(n.strong,{children:"createPool"})}),"."]}),"\n"]}),"\n",(0,a.jsxs)(t.A,{children:[(0,a.jsx)(l.A,{value:"Promise",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"import mysql from 'mysql2/promise';\n\n// Cria a conex\xe3o (pool). As defini\xe7\xf5es espec\xedficadas do \"createPool\" s\xe3o as predefini\xe7\xf5es padr\xf5es\nconst pool = mysql.createPool({\n  host: 'localhost',\n  user: 'root',\n  database: 'test',\n  waitForConnections: true,\n  connectionLimit: 10,\n  maxIdle: 10, // M\xe1ximo de conex\xf5es inativas; o valor padr\xe3o \xe9 o mesmo que \"connectionLimit\"\n  idleTimeout: 60000, // Tempo limite das conex\xf5es inativas em milissegundos; o valor padr\xe3o \xe9 \"60000\"\n  queueLimit: 0,\n  enableKeepAlive: true,\n  keepAliveInitialDelay: 0,\n});\n"})})}),(0,a.jsx)(l.A,{value:"Callback",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"const mysql = require('mysql2');\n\n// Cria a conex\xe3o (pool). As defini\xe7\xf5es espec\xedficadas do \"createPool\" s\xe3o as predefini\xe7\xf5es padr\xf5es\nconst pool = mysql.createPool({\n  host: 'localhost',\n  user: 'root',\n  database: 'test',\n  waitForConnections: true,\n  connectionLimit: 10,\n  maxIdle: 10, // M\xe1ximo de conex\xf5es inativas; o valor padr\xe3o \xe9 o mesmo que \"connectionLimit\"\n  idleTimeout: 60000, // Tempo limite das conex\xf5es inativas em milissegundos; o valor padr\xe3o \xe9 \"60000\"\n  queueLimit: 0,\n  enableKeepAlive: true,\n  keepAliveInitialDelay: 0,\n});\n"})})})]}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["O ",(0,a.jsx)(n.em,{children:"pool"})," n\xe3o estabelece todas as conex\xf5es previamente, mas as cria sob demanda at\xe9 que o limite de conex\xf5es seja atingido."]})}),"\n",(0,a.jsx)("hr",{}),"\n",(0,a.jsxs)(n.p,{children:["Voc\xea pode usar o ",(0,a.jsx)(n.em,{children:"pool"})," da mesma maneira como em uma conex\xe3o (usando ",(0,a.jsx)(n.code,{children:"pool.query()"})," e ",(0,a.jsx)(n.code,{children:"pool.execute()"}),"):"]}),"\n",(0,a.jsxs)(t.A,{children:[(0,a.jsx)(l.A,{value:"Promise",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"try {\n  // Para a inicializa\xe7\xe3o do \"pool\", veja acima\n  const [rows, fields] = await pool.query('SELECT `field` FROM `table`');\n  // A conex\xe3o \xe9 automaticamente liberada quando a consulta (query) \xe9 resolvida\n} catch (err) {\n  console.log(err);\n}\n"})})}),(0,a.jsx)(l.A,{value:"Callback",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"// Para a inicializa\xe7\xe3o do \"pool\", veja acima\npool.query('SELECT `field` FROM `table`', function (err, rows, fields) {\n  // A conex\xe3o \xe9 automaticamente liberada quando a consulta (query) \xe9 resolvida\n});\n"})})})]}),"\n",(0,a.jsx)(n.p,{children:"Alternativamente, tamb\xe9m existe a possibilidade de adquirir manualmente uma conex\xe3o do pool e liber\xe1-la posteriormente:"}),"\n",(0,a.jsxs)(t.A,{children:[(0,a.jsx)(l.A,{value:"Promise",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'// Para a inicializa\xe7\xe3o do "pool", veja acima\nconst conn = await pool.getConnection();\n\n// Fazer algo com a conex\xe3o\nawait conn.query(/* ... */);\n\n// N\xe3o se esque\xe7a de liberar a conex\xe3o quando terminar!\npool.releaseConnection(conn);\n'})})}),(0,a.jsx)(l.A,{value:"Callback",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:'// Para a inicializa\xe7\xe3o do "pool", veja acima\npool.getConnection(function (err, conn) {\n  // Fazer algo com a conex\xe3o\n  conn.query(/* ... */);\n\n  // N\xe3o se esque\xe7a de liberar a conex\xe3o quando terminar!\n  pool.releaseConnection(conn);\n});\n'})})})]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:["Adicionalmente, voc\xea pode liberar a conex\xe3o usando o objeto ",(0,a.jsx)(n.code,{children:"connection"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"conn.release();\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)("hr",{}),"\n",(0,a.jsxs)(n.h3,{id:"usando-o-promise-wrapper",children:["Usando o ",(0,a.jsx)(n.em,{children:"Promise Wrapper"})]}),"\n",(0,a.jsxs)(n.p,{children:["O MySQL2 tamb\xe9m suporta ",(0,a.jsx)(n.em,{children:"Promise"})," API. O que funciona muito bem com o ES7 ",(0,a.jsx)(n.em,{children:"async await"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"import mysql from 'mysql2/promise';\n\nasync function main() {\n  // Cria a conex\xe3o com o Banco de Dados\n  const connection = await mysql.createConnection({\n    host: 'localhost',\n    user: 'root',\n    database: 'test',\n  });\n\n  // Consulta no Banco de Dados\n  const [rows, fields] = await connection.execute(\n    'SELECT * FROM `table` WHERE `name` = ? AND `age` > ?',\n    ['Morty', 14]\n  );\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:["O MySQL2 usa o objeto ",(0,a.jsx)(n.em,{children:(0,a.jsx)(n.code,{children:"Promise"})})," padr\xe3o dispon\xedvel no escopo. Mas voc\xea pode escolher qual implementa\xe7\xe3o de ",(0,a.jsx)(n.em,{children:(0,a.jsx)(n.code,{children:"Promise"})})," deseja usar."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"// Obt\xe9m o cliente\nimport mysql from 'mysql2/promise';\n\n// Obt\xe9m a implementa\xe7\xe3o de \"Promise\" (n\xf3s usaremos o \"bluebird\")\nimport bluebird from 'bluebird';\n\n// Cria a conex\xe3o, especificando o \"bluebird\" como \"Promise\"\nconst connection = await mysql.createConnection({\n  host: 'localhost',\n  user: 'root',\n  database: 'test',\n  Promise: bluebird,\n});\n\n// Consulta no Banco de Dados\nconst [rows, fields] = await connection.execute(\n  'SELECT * FROM `table` WHERE `name` = ? AND `age` > ?',\n  ['Morty', 14]\n);\n"})}),"\n",(0,a.jsxs)(n.p,{children:["MySQL2 also exposes a ",(0,a.jsx)(n.code,{children:".promise()"})," function on Pools, so you can create a promise/non-promise connections from the same pool."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",children:"import mysql from 'mysql2';\n\nasync function main() {\n  // create the pool\n  const pool = mysql.createPool({\n    host: 'localhost',\n    user: 'root',\n    database: 'test',\n  });\n\n  // now get a Promise wrapped instance of that pool\n  const promisePool = pool.promise();\n\n  // query database using promises\n  const [rows, fields] = await promisePool.query('SELECT 1');\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:["O MySQL2 tamb\xe9m exp\xf5e o m\xe9todo .promise() em ",(0,a.jsx)(n.em,{children:"Pools"}),', ent\xe3o voc\xea pode criar conex\xf5es "',(0,a.jsx)(n.em,{children:"promise/non-promise"}),'" para o mesmo ',(0,a.jsx)(n.em,{children:"pool"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:"{11}",children:"const mysql = require('mysql2');\n\n// Cria a conex\xe3o\nconst conn = mysql.createConnection({\n  host: 'localhost',\n  user: 'root',\n  database: 'test',\n});\n\nconn\n  .promise()\n  .query('SELECT 1')\n  .then(([rows, fields]) => {\n    console.log(rows);\n  })\n  .catch(console.log)\n  .then(() => conn.end());\n"})}),"\n",(0,a.jsx)("hr",{}),"\n",(0,a.jsxs)(n.h3,{id:"resultados-em-array",children:["Resultados em ",(0,a.jsx)(n.em,{children:"Array"})]}),"\n",(0,a.jsxs)(n.p,{children:["Se voc\xea tiver duas colunas com o mesmo nome, pode preferir receber os resultados como um ",(0,a.jsx)(n.em,{children:"array"}),", em vez de um objeto, para evitar conflitos. Isso \xe9 uma diverg\xeancia da biblioteca ",(0,a.jsx)(n.a,{href:"https://github.com/mysqljs/mysql",children:"Node MySQL"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["Por exemplo: ",(0,a.jsx)(n.code,{children:"SELECT 1 AS `foo`, 2 AS `foo`"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Voc\xea pode habilitar essa configura\xe7\xe3o tanto no n\xedvel de conex\xe3o (aplica-se a todas as consultas), quanto no n\xedvel de consulta (aplica-se apenas a essa consulta espec\xedfica)."}),"\n",(0,a.jsx)(n.h4,{id:"connection-level",children:"Connection Level"}),"\n",(0,a.jsxs)(t.A,{children:[(0,a.jsx)(l.A,{value:"Promise",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:"{5}",children:"const conn = await mysql.createConnection({\n  host: 'localhost',\n  database: 'test',\n  user: 'root',\n  rowsAsArray: true,\n});\n"})})}),(0,a.jsx)(l.A,{value:"Callback",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:"{5}",children:"const conn = mysql.createConnection({\n  host: 'localhost',\n  database: 'test',\n  user: 'root',\n  rowsAsArray: true,\n});\n"})})})]}),"\n",(0,a.jsx)(n.h4,{id:"query-level",children:"Query Level"}),"\n",(0,a.jsxs)(t.A,{children:[(0,a.jsx)(l.A,{value:"Promise",default:!0,children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:"{4}",children:'try {\n  const [results, fields] = await conn.query({\n    sql: \'SELECT 1 AS `foo`, 2 AS `foo`\',\n    rowsAsArray: true,\n  });\n\n  console.log(results); // nessa consulta, "results" cont\xeam um array de arrays ao inv\xe9s de um array de objetos\n  console.log(fields); // "fields" mant\xeam-se inalterados\n} catch (err) {\n  console.log(err);\n}\n'})})}),(0,a.jsx)(l.A,{value:"Callback",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:"{4}",children:'conn.query(\n  {\n    sql: \'SELECT 1 AS `foo`, 2 AS `foo`\',\n    rowsAsArray: true,\n  },\n  function (err, results, fields) {\n    console.log(results); // nessa consulta, "results" cont\xeam um array de arrays ao inv\xe9s de um array de objetos\n    console.log(fields); // "fields" mant\xeam-se inalterados\n  }\n);\n'})})})]}),"\n",(0,a.jsx)("hr",{}),"\n",(0,a.jsx)(n.admonition,{title:"Obtendo Ajuda",type:"tip",children:(0,a.jsxs)(n.p,{children:["Precisa de ajuda? Fa\xe7a sua pergunta no ",(0,a.jsx)(n.a,{href:"https://stackoverflow.com/questions/tagged/mysql2",children:"Stack Overflow"})," ou ",(0,a.jsx)(n.a,{href:"https://github.com/sidorares/node-mysql2/discussions",children:"GitHub"}),".\nSe voc\xea encontrou um erro, ",(0,a.jsx)(n.a,{href:"https://github.com/sidorares/node-mysql2/issues",children:"registre-o no GitHub"}),"."]})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var o=s(6540);const a={},r=o.createContext(a);function t(e){const n=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),o.createElement(r.Provider,{value:n},e.children)}},9365:(e,n,s)=>{s.d(n,{A:()=>t});s(6540);var o=s(4164);const a={tabItem:"tabItem_Ymn6"};var r=s(4848);function t({children:e,hidden:n,className:s}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,o.A)(a.tabItem,s),hidden:n,children:e})}}}]);